version: '3'
services:
  client-app:
    depends_on:
      - backend
    build:
      context:
        ./frontend
    ports:
      - "80:80"
    volumes:
      - ./backend/nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./backend/app/app.db:/var/db_data/app.db
    environment:
      - DATABASE_URL=sqlite:///var/db_data/app.db
    networks:
     - web_nw
  backend:
    # depends_on:
    #   - db
    build:
      context:
        ./backend
    networks:
     - web_nw
     - db_nw
  # TODO Use postgres db instead of sqlite
  # db:
  #   image: "postgres:9.6.5"
  #   networks:
  #     - db_nw

networks:
  web_nw:
    driver: bridge
  db_nw:
    driver: bridge
